/**
 * skylark-texts-plain - The skylarkjs plain utility Library.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(t,e){var n=e.define,require=e.require,i="function"==typeof n&&n.amd,s=!i&&"undefined"!=typeof exports;if(!i&&!n){var r={};n=e.define=function(t,e,n){"function"==typeof n?(r[t]={factory:n,deps:e.map(function(e){return function(t,e){if("."!==t[0])return t;var n=e.split("/"),i=t.split("/");n.pop();for(var s=0;s<i.length;s++)"."!=i[s]&&(".."==i[s]?n.pop():n.push(i[s]));return n.join("/")}(e,t)}),resolved:!1,exports:null},require(t)):r[t]={factory:null,resolved:!0,exports:n}},require=e.require=function(t){if(!r.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var module=r[t];if(!module.resolved){var n=[];module.deps.forEach(function(t){n.push(require(t))}),module.exports=module.factory.apply(e,n)||null,module.resolved=!0}return module.exports}}if(!n)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(t,require){t("skylark-texts-plain/plain",["skylark-langx/skylark"],function(t){return skyalark.attach("plain.plain")}),t("skylark-texts-plain/position",["skylark-langx/klass","skylark-langx/objects","./plain"],function(t,e,n){var i=t({_construct:function(t,e,n=null){this.line=t,this.ch=e,this.sticky=n},compareTo:function(t){return t&&(this.line-t.line||this.ch-t.ch)},clone:function(){return new i(this.line,thie.ch)},equals:function(t){return t&&this.sticky==t.sticky&&0==this.compareTo(t)},clipToLen:function(t){let e=this.ch;return null==e||e>t?new i(this.line,t):e<0?new i(this.line,0):this}});return i.compare=function(t,e){return t.compareTo(e)},Postion.copy=function(t){return t.clone()},i.max=function(t,e){return cmp(t,e)<0?e:t},i.min=function(t,e){return cmp(t,e)<0?t:e},i.equal=function(t,e){return t&&t.equals(e)},n.Position=i}),t("skylark-texts-plain/range",["skylark-langx/klass","./plain","./position"],function(t,e,n){var i=t({klassName:"Range",_construct:function(t,e){this.anchor=t,this.head=e},from:function(){return Positon.min(this.anchor,this.head)},to:function(){return Position.max(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},extend:function(t,e,n){if(n){let n=this.anchor;if(e){let i=Position.compare(t,n)<0;i!=Position.compare(e,n)<0?(n=t,t=e):i!=Position.compare(t,e)<0&&(t=e)}return new i(n,t)}return new i(e||t,t)}});return e.Range=i}),t("skylark-texts-plain/selection",["skylark-langx/klass","./plain","./position","./range"],function(t,e,n,i){var s=t({klassName:"Selection",_construct:function(t,e){this.ranges=t,this.primIndex=e},primary:function(){return this.ranges[this.primIndex]},equals:function(t){if(t==this)return!0;if(t.primIndex!=this.primIndex||t.ranges.length!=this.ranges.length)return!1;for(var e=0;e<this.ranges.length;e++){var i=this.ranges[e],s=t.ranges[e];if(0!=n.compare(i.anchor,s.anchor)||0!=n.compare(i.head,s.head))return!1}return!0},deepCopy:function(){for(var t=[],e=0;e<this.ranges.length;e++)t[e]=new i(copyPos(this.ranges[e].anchor),copyPos(this.ranges[e].head));return new s(t,this.primIndex)},somethingSelected:function(){for(var t=0;t<this.ranges.length;t++)if(!this.ranges[t].empty())return!0;return!1},contains:function(t,e){e||(e=t);for(var i=0;i<this.ranges.length;i++){var s=this.ranges[i];if(n.compare(e,s.from())>=0&&n.compare(t,s.to())<=0)return i}return-1}});return s.normalize=function(t,e,r){let l=e[r];e.sort((t,e)=>n.compare(t.from(),e.from())),r=arrays.indexOf(e,l);for(let s=1;s<e.length;s++){let l=e[s],o=e[s-1],h=n.compare(o.to(),l.from());if(t&&!l.empty()?h>0:h>=0){let t=n.min(o.from(),l.from()),h=n.max(o.to(),l.to()),a=o.empty()?l.from()==l.head:o.from()==o.head;s<=r&&--r,e.splice(--s,2,new i(a?h:t,a?t:h))}}return new s(e,r)},s.simple=function(t,e){return new s([new i(t,e||t)],0)},e.Selection=s}),t("skylark-texts-plain/line",["skylark-langx/Evented","./plain"],function(t,e){var n=t.inherit({_construct:function(t,e,n){this.text=t,this.attachMarkedSpans&&this.attachMarkedSpans(e),this.updateLineHeight&&(this.height=n?n(this):1)},lineNo:function(){if(null==this.parent)return null;for(var t=this.parent,e=indexOf(t.lines,this),n=t.parent;n;t=n,n=n.parent)for(var i=0;n.children[i]!=t;++i)e+=n.children[i].chunkSize();return e+t.first},updateLine:function(t,e,n){if(this.text=t,this.stateAfter&&(this.stateAfter=null),this.styles&&(this.styles=null),null!=this.order&&(this.order=null),this.detachMarkedSpans&&this.detachMarkedSpans(),this.attachMarkedSpans&&this.attachMarkedSpans(e),this.updateLineHeight){var i=n?n(this):1;i!=this.height&&this.updateLineHeight(i)}},cleanUpLine:function(){this.parent=null,this.detachMarkedSpans&&this.detachMarkedSpans()}});n.countColumn=function(t,e,n,i,s){null==e&&-1==(e=t.search(/[^\s\u00a0]/))&&(e=t.length);for(var r=i||0,l=s||0;;){var o=t.indexOf("\t",r);if(o<0||o>=e)return l+(e-r);l+=o-r,l+=n-l%n,r=o+1}},n.findColumn=function(t,e,n){for(var i=0,s=0;;){var r=t.indexOf("\t",i);-1==r&&(r=t.length);var l=r-i;if(r==t.length||s+l>=e)return i+Math.min(l,e-s);if(s+=r-i,i=r+1,(s+=n-s%n)>=e)return i}};return e.Line=n}),t("skylark-texts-plain/leaf_chunk",["skylark-langx/Evented","./plain"],function(t,e){var n=t.inherit({klassName:"LeafChunk",_construct:function(t){this.lines=t,this.parent=null;for(var e=0,n=0;e<t.length;++e)t[e].parent=this,n+=t[e].height;this.height=n},chunkSize:function(){return this.lines.length},removeInner:function(t,e){for(var n=t,i=t+e;n<i;++n){var s=this.lines[n];this.height-=s.height,s.cleanUpLine(),this.emit("delete",s)}this.lines.splice(t,e)},collapse:function(t){t.push.apply(t,this.lines)},insertInner:function(t,e,n){this.height+=n,this.lines=this.lines.slice(0,t).concat(e).concat(this.lines.slice(t));for(var i=0;i<e.length;++i)e[i].parent=this},iterN:function(t,e,n){for(var i=t+e;t<i;++t)if(n(this.lines[t]))return!0}});return e.LeafChunk=n}),t("skylark-texts-plain/branch_chunk",["skylark-langx/Evented","./plain","./leaf_chunk"],function(t,e,n){var i=t.inherit({klassName:"BranchChunk",_construct:function(t){this.children=t;for(var e=0,n=0,i=0;i<t.length;++i){var s=t[i];e+=s.chunkSize(),n+=s.height,s.parent=this}this.size=e,this.height=n,this.parent=null},chunkSize:function(){return this.size},removeInner:function(t,e){this.size-=e;for(var i=0;i<this.children.length;++i){var s=this.children[i],r=s.chunkSize();if(t<r){var l=Math.min(e,r-t),o=s.height;if(s.removeInner(t,l),this.height-=o-s.height,r==l&&(this.children.splice(i--,1),s.parent=null),0==(e-=l))break;t=0}else t-=r}if(this.size-e<25&&(this.children.length>1||!(this.children[0]instanceof n))){var h=[];this.collapse(h),this.children=[new n(h)],this.children[0].parent=this}},collapse:function(t){for(var e=0;e<this.children.length;++e)this.children[e].collapse(t)},insertInner:function(t,e,i){this.size+=e.length,this.height+=i;for(var s=0;s<this.children.length;++s){var r=this.children[s],l=r.chunkSize();if(t<=l){if(r.insertInner(t,e,i),r.lines&&r.lines.length>50){for(var o=r.lines.length%25+25,h=o;h<r.lines.length;){var a=new n(r.lines.slice(h,h+=25));r.height-=a.height,this.children.splice(++s,0,a),a.parent=this}r.lines=r.lines.slice(0,o),this.maybeSpill()}break}t-=l}},maybeSpill:function(){if(!(this.children.length<=10)){var t=this;do{var e=t.children.splice(t.children.length-5,5),n=new i(e);if(t.parent){t.size-=n.size,t.height-=n.height;var s=indexOf(t.parent.children,t);t.parent.children.splice(s+1,0,n)}else{var r=new i(t.children);r.parent=t,t.children=[r,n],t=r}n.parent=t.parent}while(t.children.length>10);t.parent.maybeSpill()}},iterN:function(t,e,n){for(var i=0;i<this.children.length;++i){var s=this.children[i],r=s.chunkSize();if(t<r){var l=Math.min(e,r-t);if(s.iterN(t,l,n))return!0;if(0==(e-=l))break;t=0}else t-=r}}});return e.BranchChunk=i}),t("skylark-texts-plain/history",["skylark-langx-arrays","./position","./selection"],function(t,e,n){"use strict";function i(t){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=t||1}function s(t,n){let i={from:e.copy(n.from),to:change_measurement.changeEnd(n),text:t.getBetween(n.from,n.to)};return o(t,i,n.from.line,n.to.line+1),document_data.linkedDocs(t,t=>o(t,i,n.from.line,n.to.line+1),!0),i}function r(e){for(;e.length;){let n=t.last(e);if(!n.ranges)break;e.pop()}}function l(e,n){let i=t.last(n);i&&i.ranges&&i.equals(e)||n.push(e)}function o(t,e,n,i){let s=e["spans_"+t.id],r=0;t.iter(Math.max(t.first,n),Math.min(t.first+t.size,i),n=>{n.markedSpans&&((s||(s=e["spans_"+t.id]={}))[r]=n.markedSpans),++r})}function h(t){if(!t)return null;let e;for(let n=0;n<t.length;++n)t[n].marker.explicitlyCleared?e||(e=t.slice(0,n)):e&&e.push(t[n]);return e?e.length?e:null:t}return i.historyChangeFromChange=s,i.addChangeToHistory=function(n,i,o,h){let a=n.history;a.undone.length=0;let c,u,f=+new Date;if((a.lastOp==h||a.lastOrigin==i.origin&&i.origin&&("+"==i.origin.charAt(0)&&a.lastModTime>f-(n.cm?n.cm.options.historyEventDelay:500)||"*"==i.origin.charAt(0)))&&(c=function(e,n){if(n)return r(e.done),t.last(e.done);if(e.done.length&&!t.last(e.done).ranges)return t.last(e.done);if(e.done.length>1&&!e.done[e.done.length-2].ranges)return e.done.pop(),t.last(e.done)}(a,a.lastOp==h)))u=t.last(c.changes),0==e.compare(i.from,i.to)&&0==e.compare(i.from,u.to)?u.to=change_measurement.changeEnd(i):c.changes.push(s(n,i));else{let e=t.last(a.done);for(e&&e.ranges||l(n.sel,a.done),c={changes:[s(n,i)],generation:a.generation},a.done.push(c);a.done.length>a.undoDepth;)a.done.shift(),a.done[0].ranges||a.done.shift()}a.done.push(o),a.generation=++a.maxGeneration,a.lastModTime=a.lastSelTime=f,a.lastOp=a.lastSelOp=h,a.lastOrigin=a.lastSelOrigin=i.origin,u||n.emit("historyAdded")},i.addSelectionToHistory=function(e,n,i,s){let o=e.history,h=s&&s.origin;i==o.lastSelOp||h&&o.lastSelOrigin==h&&(o.lastModTime==o.lastSelTime&&o.lastOrigin==h||function(t,e,n,i){let s=e.charAt(0);return"*"==s||"+"==s&&n.ranges.length==i.ranges.length&&n.somethingSelected()==i.somethingSelected()&&new Date-t.history.lastSelTime<=(t.cm?t.cm.options.historyEventDelay:500)}(e,h,t.last(o.done),n))?o.done[o.done.length-1]=n:l(n,o.done);o.lastSelTime=+new Date,o.lastSelOrigin=h,o.lastSelOp=i,s&&!1!==s.clearRedo&&r(o.undone)},i.pushSelectionToHistory=l,i.mergeOldSpans=function(t,e){let n=function(t,e){let n=e["spans_"+t.id];if(!n)return null;let i=[];for(let t=0;t<e.text.length;++t)i.push(h(n[t]));return i}(t,e),i=spans.stretchSpansOverChange(t,e);if(!n)return i;if(!i)return n;for(let t=0;t<n.length;++t){let e=n[t],s=i[t];if(e&&s)t:for(let t=0;t<s.length;++t){let n=s[t];for(let t=0;t<e.length;++t)if(e[t].marker==n.marker)continue t;e.push(n)}else s&&(n[t]=s)}return n},i.copyHistoryArray=function(e,i,s){let r=[];for(let o=0;o<e.length;++o){let h=e[o];if(h.ranges){r.push(s?n.prototype.deepCopy.call(h):h);continue}let a=h.changes,c=[];r.push({changes:c});for(let e=0;e<a.length;++e){let n,s=a[e];if(c.push({from:s.from,to:s.to,text:s.text}),i)for(var l in s)(n=l.match(/^spans_(\d+)$/))&&t.indexOf(i,Number(n[1]))>-1&&(t.last(c)[l]=s[l],delete s[l])}}return r},i}),t("skylark-texts-plain/document",["skylark-langx/arrays","skylark-langx/Evented","./plain","./branch_chunk","./leaf_chunk","./position","./selection","./history"],function(t,e,n,i,s,r,l,o){"use strict";let h=0;var a=i.inherit({_construct:function(t,e,n,i,o){null==n&&(n=0),thie.overrited(new s([new Line("",null)])),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=n;let a=new r(n,0);this.sel=l.simple(a),this.history=new m_history.History(null),this.id=++h,this.modeOption=e,this.lineSep=i,this.direction="rtl"==o?"rtl":"ltr",this.extend=!1,"string"==typeof t&&(t=this.splitLines(t)),document_data.updateDoc(this,{from:a,to:a,text:t}),selection_updates.setSelection(this,l.simple(a),misc.sel_dontScroll)},iter:function(t,e,n){n?this.iterN(t-this.first,e-t,n):this.iterN(this.first,this.first+this.size,t)},insert:function(t,e){let n=0;for(let t=0;t<e.length;++t)n+=e[t].height;this.insertInner(t-this.first,e,n)},remove:function(t,e){this.removeInner(t-this.first,e)},getValue:function(t){let e=this.getLines(this.first,this.first+this.size);return!1===t?e:e.join(t||this.lineSeparator())},setValue:function(t){let e=new r(this.first,0),n=this.first+this.size-1;changes.makeChange(this,{from:e,to:new r(n,this.getLineHandle(n).text.length),text:this.splitLines(t),origin:"setValue",full:!0},!0),this.cm&&scrolling.scrollToCoords(this.cm,0,0),selection_updates.setSelection(this,l.simple(e),misc.sel_dontScroll)},replaceRange:function(t,e,n,i){e=this.clipPos(e),n=n?this.clipPos(n):e,changes.replaceRange(this,t,e,n,i)},getRange:function(t,e,n){let i=this.getBetween(this.clipPos(t),this.clipPos(e));return!1===n?i:i.join(n||this.lineSeparator())},getBetween:function(t,e){let n=[],i=t.line;return this.iter(t.line,e.line+1,s=>{let r=s.text;i==e.line&&(r=r.slice(0,e.ch)),i==t.line&&(r=r.slice(t.ch)),n.push(r),++i}),n},getLine:function(t){let e=this.getLineHandle(t);return e&&e.text},getLines:function(t,e){let n=[];return this.iter(t,e,t=>{n.push(t.text)}),n},getLineHandle:function(t){if((t-=this.first)<0||t>=this.size)throw new Error("There is no line "+(t+this.first)+" in the document.");let e=this;for(;!e.lines;)for(let n=0;;++n){let i=e.children[n],s=i.chunkSize();if(t<s){e=i;break}t-=s}return e.lines[t]},getLineNumber:function(e){if(null==e.parent)return null;let n=e.parent,i=t.indexOf(n.lines,e);for(let t=n.parent;t;n=t,t=t.parent)for(let e=0;t.children[e]!=n;++e)i+=t.children[e].chunkSize();return i+n.first},getLineHandleVisualStart:function(t){return"number"==typeof t&&(t=this.getLineHandle(t)),spans.visualLine(t)},isLine:function(t){return t>=this.first&&t<this.first+this.size},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(t){if(t.line<this.first)return new r(this.first,0);let e=this.first+this.size-1;return t.line>e?r(e,this.getLineHandle(e).text.length):t.clipToLen(this.getLineHandle(t.line).text.length)},getCursor:function(t){let e,n=this.sel.primary();return e=null==t||"head"==t?n.head:"anchor"==t?n.anchor:"end"==t||"to"==t||!1===t?n.to():n.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:function(t,e,n){selection_updates.setSimpleSelection(this,this.clipPos("number"==typeof t?new r(t,e||0):t),null,n)},setSelection:function(t,e,n){selection_updates.setSimpleSelection(this,this.clipPos(t),this.clipPos(e||t),n)},extendSelection:function(t,e,n){selection_updates.extendSelection(this,this.clipPos(t),e&&this.clipPos(e),n)},extendSelections:function(t,e){selection_updates.extendSelections(this,m_pos.clipPosArray(this,t),e)},extendSelectionsBy:function(t,e){let n=misc.map(this.sel.ranges,t);selection_updates.extendSelections(this,m_pos.clipPosArray(this,n),e)},setSelections:function(t,e,n){if(!t.length)return;let i=[];for(let e=0;e<t.length;e++)i[e]=new m_selection.Range(this.clipPos(t[e].anchor),this.clipPos(t[e].head));null==e&&(e=Math.min(t.length-1,this.sel.primIndex)),selection_updates.setSelection(this,l.normalize(this.cm,i,e),n)},addSelection:function(t,e,n){let i=this.sel.ranges.slice(0);i.push(new m_selection.Range(this.clipPos(t),this.clipPos(e||t))),selection_updates.setSelection(this,m_selection.normalizeSelection(this.cm,i,i.length-1),n)},getSelection:function(t){let e,n=this.sel.ranges;for(let t=0;t<n.length;t++){let i=this.getBetween(n[t].from(),n[t].to());e=e?e.concat(i):i}return!1===t?e:e.join(t||this.lineSeparator())},getSelections:function(t){let e=[],n=this.sel.ranges;for(let i=0;i<n.length;i++){let s=this.getBetween(n[i].from(),n[i].to());!1!==t&&(s=s.join(t||this.lineSeparator())),e[i]=s}return e},replaceSelection:function(t,e,n){let i=[];for(let e=0;e<this.sel.ranges.length;e++)i[e]=t;this.replaceSelections(i,e,n||"+input")},replaceSelections:function(t,e,n){let i=[],s=this.sel;for(let e=0;e<s.ranges.length;e++){let r=s.ranges[e];i[e]={from:r.from(),to:r.to(),text:this.splitLines(t[e]),origin:n}}let r=e&&"end"!=e&&change_measurement.computeReplacedSel(this,i,e);for(let t=i.length-1;t>=0;t--)i.makeChange(this,i[t]);r?selection_updates.setSelectionReplaceHistory(this,r):this.cm&&scrolling.ensureCursorVisible(this.cm)},undo:function(){changes.makeChangeFromHistory(this,"undo")},redo:function(){changes.makeChangeFromHistory(this,"redo")},undoSelection:function(){changes.makeChangeFromHistory(this,"undo",!0)},redoSelection:function(){changes.makeChangeFromHistory(this,"redo",!0)},setExtending:function(t){this.extend=t},getExtending:function(){return this.extend},historySize:function(){let t=this.history,e=0,n=0;for(let n=0;n<t.done.length;n++)t.done[n].ranges||++e;for(let e=0;e<t.undone.length;e++)t.undone[e].ranges||++n;return{undo:e,redo:n}},clearHistory:function(){this.history=new m_history.History(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(t){return t&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(t){return this.history.generation==(t||this.cleanGeneration)},getHistory:function(){return{done:m_history.copyHistoryArray(this.history.done),undone:m_history.copyHistoryArray(this.history.undone)}},setHistory:function(t){let e=this.history=new m_history.History(this.history.maxGeneration);e.done=m_history.copyHistoryArray(t.done.slice(0),null,!0),e.undone=m_history.copyHistoryArray(t.undone.slice(0),null,!0)},setGutterMarker:function(t,e,n){return changes.changeLine(this,t,"gutter",t=>{let i=t.gutterMarkers||(t.gutterMarkers={});return i[e]=n,!n&&misc.isEmpty(i)&&(t.gutterMarkers=null),!0})},clearGutter:function(t){this.iter(e=>{e.gutterMarkers&&e.gutterMarkers[t]&&changes.changeLine(this,e,"gutter",()=>(e.gutterMarkers[t]=null,misc.isEmpty(e.gutterMarkers)&&(e.gutterMarkers=null),!0))})},lineInfo:function(t){let e;if("number"==typeof t){if(!this.isLine(t))return null;if(e=t,!(t=this.getLineHandle(t)))return null}else if(null==(e=this.getLineNumber(t)))return null;return{line:e,handle:t,text:t.text,gutterMarkers:t.gutterMarkers,textClass:t.textClass,bgClass:t.bgClass,wrapClass:t.wrapClass,widgets:t.widgets}},addLineClass:function(t,e,n){return changes.changeLine(this,t,"gutter"==e?"gutter":"class",t=>{let i="text"==e?"textClass":"background"==e?"bgClass":"gutter"==e?"gutterClass":"wrapClass";if(t[i]){if(dom.classTest(n).test(t[i]))return!1;t[i]+=" "+n}else t[i]=n;return!0})},removeLineClass:function(t,e,n){return changes.changeLine(this,t,"gutter"==e?"gutter":"class",t=>{let i="text"==e?"textClass":"background"==e?"bgClass":"gutter"==e?"gutterClass":"wrapClass",s=t[i];if(!s)return!1;if(null==n)t[i]=null;else{let e=s.match(dom.classTest(n));if(!e)return!1;let r=e.index+e[0].length;t[i]=s.slice(0,e.index)+(e.index&&r!=s.length?" ":"")+s.slice(r)||null}return!0})},addLineWidget:function(t,e,n){return line_widget.addLineWidget(this,t,e,n)},removeLineWidget:function(t){t.clear()},markText:function(t,e,n){return mark_text.markText(this,this.clipPos(t),this.clipPos(e),n,n&&n.type||"range")},setBookmark:function(t,e){let n={replacedWith:e&&(null==e.nodeType?e.widget:e),insertLeft:e&&e.insertLeft,clearWhenEmpty:!1,shared:e&&e.shared,handleMouseEvents:e&&e.handleMouseEvents};return t=this.clipPos(t),p.markText(this,t,t,n,"bookmark")},findMarksAt:function(t){t=this.clipPos(t);let e=[],n=this.getLineHandle(t.line).markedSpans;if(n)for(let i=0;i<n.length;++i){let s=n[i];(null==s.from||s.from<=t.ch)&&(null==s.to||s.to>=t.ch)&&e.push(s.marker.parent||s.marker)}return e},findMarks:function(t,e,n){t=this.clipPos(t),e=this.clipPos(e);let i=[],s=t.line;return this.iter(t.line,e.line+1,r=>{let l=r.markedSpans;if(l)for(let r=0;r<l.length;r++){let o=l[r];null!=o.to&&s==t.line&&t.ch>=o.to||null==o.from&&s!=t.line||null!=o.from&&s==e.line&&o.from>=e.ch||n&&!n(o.marker)||i.push(o.marker.parent||o.marker)}++s}),i},getAllMarks:function(){let t=[];return this.iter(e=>{let n=e.markedSpans;if(n)for(let e=0;e<n.length;++e)null!=n[e].from&&t.push(n[e].marker)}),t},posFromIndex:function(t){let e,n=this.first,i=this.lineSeparator().length;return this.iter(s=>{let r=s.text.length+i;if(r>t)return e=t,!0;t-=r,++n}),this.clipPos(new r(n,e))},indexFromPos:function(t){let e=(t=this.clipPos(t)).ch;if(t.line<this.first||t.ch<0)return 0;let n=this.lineSeparator().length;return this.iter(this.first,t.line,t=>{e+=t.text.length+n}),e},copy:function(t){let e=new a(this.getLines(this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return e.scrollTop=this.scrollTop,e.scrollLeft=this.scrollLeft,e.sel=this.sel,e.extend=!1,t&&(e.history.undoDepth=this.history.undoDepth,e.setHistory(this.getHistory())),e},linkedDoc:function(t){t||(t={});let e=this.first,n=this.first+this.size;null!=t.from&&t.from>e&&(e=t.from),null!=t.to&&t.to<n&&(n=t.to);let i=new a(this.getLines(e,n),t.mode||this.modeOption,e,this.lineSep,this.direction);return t.sharedHist&&(i.history=this.history),(this.linked||(this.linked=[])).push({doc:i,sharedHist:t.sharedHist}),i.linked=[{doc:this,isParent:!0,sharedHist:t.sharedHist}],line_widget.copySharedMarkers(i,line_widget.findSharedMarkers(this)),i},unlinkDoc:function(t){if(t.doc&&(t=t.doc),this.linked)for(let e=0;e<this.linked.length;++e){let n=this.linked[e];if(n.doc==t){this.linked.splice(e,1),t.unlinkDoc(this),line_widget.detachSharedMarkers(line_widget.findSharedMarkers(this));break}}if(t.history==this.history){let e=[t.id];document_data.linkedDocs(t,t=>e.push(t.id),!0),t.history=new m_history.History(null),t.history.done=m_history.copyHistoryArray(this.history.done,e),t.history.undone=m_history.copyHistoryArray(this.history.undone,e)}},iterLinkedDocs:function(t){document_data.linkedDocs(this,t)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(t){return this.lineSep?t.split(this.lineSep):feature_detection.splitLinesAuto(t)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:function(t){"rtl"!=t&&(t="ltr"),t!=this.direction&&(this.direction=t,this.iter(t=>t.order=null),this.emit("directionChanged"))}});return a.prototype.eachLine=a.prototype.iter,n.Document=a}),t("skylark-texts-plain/main",["./plain","./position","./range","./selection","./line","./leaf_chunk","./branch_chunk","./document"],function(t){return t}),t("skylark-texts-plain",["skylark-texts-plain/main"],function(t){return t})}(n),!i){var l=require("skylark-langx-ns");s?module.exports=l:e.skylarkjs=l}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-texts-plain.js.map
